##### 数据库与缓存一致性问题（先删除缓存还是先更新数据库）
1. 先删除缓存，再更新数据库。由于缓存被线程A删除，短时间内如果有另一个线程B请求该数据，因为缓存没有，所以B到数据库中查询，之后再把查询到的数据放入缓存中。此时，如果A没有在B读取之前更新好数据，那么这意味着B获得是旧值，然后B放入缓存中的数据是旧的，在下一次更新数据之前，缓存中的数据都是错的，会产生脏读。
2. 先更新数据库，再删除缓存。由于线程A在更新数据，此时线程B来获取数据，获取的是缓存中的数据。A更新完以后，把缓存删除，再插入（更新缓存）。这样，即使在更新缓存前有线程获取了错的数据，产生脏读，但是不致于短时间内所有线程获取的数据都是错的。
3. 比较1 2两种方法，虽然都产生脏读，但是第一种产生长时间的脏读，第二种是短时间的。而且第一种，在缓存不存在的情况下，有可能有大量请求访问数据库，增加数据库的压力。而第二种数据库不会有太大压力，数据库更新以后缓存也更新。
